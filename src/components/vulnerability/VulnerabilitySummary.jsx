import React from 'react';
import {
  Box,
  Typography,
  Paper,
  Button,
  LinearProgress,
  Stack,
} from '@mui/material';
import ReplayIcon from '@mui/icons-material/Replay';

import TypeCard from './TypeCard';

// The main summary component, now acting as a clean layout/orchestrator.
const VulnerabilitySummary = ({ summary, onReset }) => {
  // Display a loading state if the summary data isn't ready yet.
  if (!summary || !summary.overall || !summary.byType) {
    return (
      <Paper elevation={3} sx={{ p: 2, borderRadius: '12px' }}>
        <Typography>Calculando resumen...</Typography>
        <LinearProgress sx={{ mt: 1 }} />
      </Paper>
    );
  }

  return (
    <Box >

      <Stack 
        direction="row"
        spacing={2}
      >
      {Object.entries(summary.byType).map(([typeName, typeData]) => (   
            <TypeCard  key={typeName} title={typeName} data={typeData} />
        ))}
      </Stack>

      <Stack 
        direction="column"
        spacing={1}
      >
      <Button variant="contained" color="primary" size="small" startIcon={<ReplayIcon />} onClick={onReset}>
        Reiniciar An√°lisis
      </Button>
      </Stack>
    </Box>
  );
};

export default VulnerabilitySummary;
