import React, { useState } from 'react';
import {
  Paper,
  Tabs,
  Tab,
  Box
} from '@mui/material';
import { vulnerabilityMatrix } from '../../data/vulnerabilidadFormFields.js';
import SubtypeAccordion from './SubtypeAccordion';

const VulnerabilityChecklist = ({ scores, onScoreChange }) => {
  const [currentTab, setCurrentTab] = useState(0);

  const handleTabChange = (_, newValue) => setCurrentTab(newValue);
  const currentType = vulnerabilityMatrix[currentTab];

  return (
    <Paper
      elevation={4}
      sx={{ p: { xs: 1, sm: 2, md: 3 }, borderRadius: '16px' }}
    >
      <Tabs
        value={currentTab}
        onChange={handleTabChange}
        variant="fullWidth"
        indicatorColor="primary"
        textColor="primary"
        sx={{ mb: 3, borderBottom: 1, borderColor: 'divider' }}
      >
        {vulnerabilityMatrix.map((tipo) => (
          <Tab key={tipo.tipo} label={tipo.tipo} sx={{ fontWeight: 600 }} />
        ))}
      </Tabs>

      <Box>
        {currentType.subtipos.map((subtipo) => (
          <SubtypeAccordion
            key={subtipo.nombre}
            subtipo={subtipo}
            scores={scores}
            onScoreChange={onScoreChange}
          />
        ))}
      </Box>
    </Paper>
  );
};

export default VulnerabilityChecklist;
